package com.demo.ExcelProject;

import java.io.BufferedReader;
import java.io.FileNotFoundException;
import java.io.FileReader;
import java.io.IOException;
import java.util.ArrayList;
import java.util.List;
import java.util.Scanner;
import org.apache.commons.csv.CSVFormat;
import org.apache.commons.csv.CSVParser;
import org.apache.commons.csv.CSVRecord;

/**
 * Java Program to parse and read CSV file using traditional BufferedReader
 * approach and by using more functional CSV parser from Apache Commons CSV
 * library. Apache Commons CSV support different CSV format including default
 * one, with or without header, reading EXCEL or XLS CSV file etc.
 *
 * @author
 */
public class CSVReader {

	private static class Country {
		private String name;
		private String capital;
		private String currency;

		public Country(String name, String capital, String currency) {
			this.name = name;
			this.capital = capital;
			this.currency = currency;
		}

		public String name() {
			return name;
		};

		public String capital() {
			return capital;
		}

		public String currency() {
			return currency;
		}

		@Override
		public String toString() {
			return "Country [name=" + name + ", capital=" + capital + ", currency=" + currency + "]";
		}
	}

	public static void main(String args[]) throws FileNotFoundException, IOException {

		System.out.println("Parsing CSV file using CSVParser of Apache commons CSV");
		String location = "C:\\\\Users\\\\junai\\\\Downloads\\\\BulkEmployees.csv";
		List<String> ar = new ArrayList<>();
		ar = parseCSV(location);
		System.out.println(ar);

	}

	/*
	 * Java program to read CVS file using BufferedReader and String split() method
	 */

	/*
	 * Method to read CSV file using CSVParser from Apache Commons CSV
	 */
	public static List<String> parseCSV(String fileLocation) throws FileNotFoundException, IOException {
		CSVParser parser = new CSVParser(new FileReader(fileLocation), CSVFormat.DEFAULT.withHeader());
		String st1 = parser.getHeaderMap().toString();
		StringBuilder sb = new StringBuilder(st1);
		List<String> paramList = new ArrayList<>();
		sb.deleteCharAt(st1.length() - 1);
		sb.deleteCharAt(0);
		List<String> response =  new ArrayList<>();
		String responseString="";
		// System.out.println(sb);
		// st1 = parser.getHeaderMap().toString().replaceAll("}", "");

		String ar[] = sb.toString().split(",");
		for (int i = 0; i < ar.length; i++) {
			String tempString = ar[i].trim();
			// System.out.println(tempString);
			String paramName = "";
			for (int j = 0; j < tempString.length(); j++) {

				if (tempString.charAt(j) == '=') {
					break;
				}
				paramName = paramName + tempString.charAt(j);

			}
			paramList.add(paramName);

		}

		for (CSVRecord record : parser) {
			for (String params : paramList) {
				//System.out.print(record.get(params).toString() + " ");
			responseString=record.get(params).toString() + " ";
			}
			response.add(responseString);
		}

		parser.close();
		return response;
	}
	
	

}
